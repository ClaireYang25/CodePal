# Hackathon 冲刺计划 (Pre-Deadline Polish Plan)

本文档定义了在 Hackathon 截止日期前，我们需要完成的最后冲刺任务。**核心原则是：不再引入任何新的、高风险的核心功能，专注于稳定、打磨和展示。**

---

## 阶段一：测试环境搭建与核心功能实现 (Testbed & Core Feature)

**目标**: 创建一个可重复、高效的测试环境，并在此基础上完成最后一个核心功能：智能自动填充。

-   [x] **1.1 创建仿真测试页面**:
    -   [x] 构建一个本地 `test-dashboard.html` 文件。
    -   [x] 页面中应包含多种类型的 OTP 输入框（模拟 Vercel, Notion, Google 等登录场景），用于测试“主动感知”和“自动填充”功能。
    -   [x] 页面中应包含一系列邮件发送按钮（简单、复杂、多语言、无效 OTP 等），用于一键触发端到端的核心提取流程。

-   [x] **1.2 构建自动填充 (Autofill) 功能**:
    -   [x] 增强 `otp-intent-listener.js`，使其不仅能发送“高警戒”信号，还能在用户聚焦输入框时，将其“标记”为潜在的填充目标。
    -   [x] 在 Service Worker 中，当成功提取 OTP 后，向当前接收到“高警戒”信号的标签页发送一个包含 OTP 的消息。
    -   [x] 对应的 Content Script 接收到消息后，将 OTP 填入之前标记的输入框中。

---

## 阶段二：全功能回归测试 (Full Regression Testing)

**目标**: 确保所有已实现的功能（包括新增的 Autofill）在各种边界条件下都能稳定工作，杜绝在演示过程中出现意外 Bug。

-   [ ] **2.1 全功能回归测试 (使用 `test-dashboard.html`)**:
    -   [ ] **新用户首次安装**: 模拟新用户，确保插件即装即用，流程顺畅。
    -   [ ] **OTP 提取（核心链路）**:
        -   [ ] **简单邮件**: 测试标准格式的 OTP 邮件（如 “Your code is 123456”）。
        -   [ ] **复杂邮件**: 测试包含多个数字（订单号、航班号）的干扰邮件。
        -   [ ] **多语言**: 测试中文、英文等不同语言的 OTP 邮件。
        -   [ ] **短验证码**: 测试位数小于 4 的 OTP，确认会被启发式规则正确拒绝（符合预期）。
    -   [ ] **“半后台”监控**: 保持 Gmail 标签页在后台，确认新邮件到达后能自动提取并更新 Popup。
    -   [ ] **主动感知**: 在测试页面的登录框，确认聚焦 OTP 输入框后，Service Worker 能收到“高警戒”信号。
    -   [ ] **自动呈现与填充**: 确认提取成功后，Popup 会自动弹出，**并且测试页面的输入框被成功填充**。
    -   [ ] **静默机制**: 确认在浏览已读邮件、发送非 OTP 邮件时，插件保持静默，不会触发任何提取。

---

## 阶段三：用户体验打磨 (UX Polish)

**目标**: 提升所有用户可见界面的质感和交互流畅度，给评委和用户留下专业、完整的印象。

-   [ ] **3.1 Popup UI 优化 (解决初始状态视觉问题)**:
    -   [ ] **修改初始/空状态**: 当用户首次打开或清除数据后，将多个蓝色下划线改为一个更简洁的加载动画 (spinner) 或静态占位符，避免歧义。
    -   [ ] **增强加载状态**: 当 Popup 打开，正在从 `storage` 读取最新 OTP 时，明确显示加载动画。
    -   [ ] **优化空状态**: 当从未提取到 OTP 时，显示一个友好的引导页，告知用户“等待新的验证码邮件...”。
    -   [ ] **一键复制**: 为显示的 OTP 数字增加一个明显的“点击复制”功能，并提供复制成功的视觉反馈。

-   [ ] **3.2 系统通知交互增强**:
    -   [ ] 为弹出的系统通知增加一个“复制验证码”的按钮，让用户可以直接从通知中获取 OTP，而无需打开 Popup。

---

## 阶段四：稳定性与文档收尾 (Stabilization & Documentation)

**目标**: 确保代码的健壮性，并准备好向评委和公众清晰、高效地展示项目亮点所需的所有材料。

-   [ ] **4.1 错误处理审查**:
    -   [ ] 逐一检查代码库中的 `console.warn` 和 `console.error` 日志，确保所有可预见的异常（如网络错误、API 限制、消息通道关闭）都得到了妥善的 `try...catch` 处理，不会导致插件崩溃。

-   [ ] **4.2 完善 `README.md`**:
    -   [ ] 更新项目截图和 GIF 动图，展示最新的 UI 和核心功能（特别是自动填充）。
    -   [ ] 简洁明了地介绍项目解决了什么问题、核心亮点是什么（三层引擎、半后台、主动感知、自动填充）。
    -   [ ] 提供清晰的安装和使用指南。

-   [ ] **4.3 准备演示材料**:
    -   [ ] 撰写一个 1-2 分钟的演示脚本，覆盖从“请求验证码”到“自动呈现与填充”的完整流畅体验。
    -   [ ] 提前录制一个完美的演示视频，以防现场网络或环境问题。

---
**结论**: 在 Deadline 之前，我们将严格遵守此计划，不再偏离。我们的目标是在现有坚实功能的基础上，交付一个稳定、精致、令人印象深刻的作品。
