# ğŸ¯ Gmail OTP AutoFill - ç®€åŒ–æ¶æ„è¯´æ˜

## ğŸ“… æ›´æ–°æ—¶é—´
2025-10-27

---

## ğŸ”„ é‡å¤§æ¶æ„å˜æ›´

### âŒ æ—§æ–¹æ¡ˆï¼ˆå·²åºŸå¼ƒï¼‰
```
Content Script â†’ Service Worker â†’ Offscreen Document â†’ Gemini Nano
```

**é—®é¢˜**ï¼š
- éœ€è¦ Chrome 116+ æ”¯æŒ Offscreen API
- æ¶æ„å¤æ‚ï¼Œéš¾ä»¥è°ƒè¯•
- æƒé™è¦æ±‚é«˜
- åˆå§‹åŒ–æ…¢

### âœ… æ–°æ–¹æ¡ˆï¼ˆå½“å‰ï¼‰
```
Content Script â†’ Service Worker â†’ Local Regex â†’ (Optional) Gemini API
                      â†“
                   Popup â†’ Gemini Nanoï¼ˆç‹¬ç«‹æµ‹è¯•ï¼‰
```

**ä¼˜ç‚¹**ï¼š
- âœ… æ— éœ€ Offscreen API
- âœ… æ¶æ„ç®€å•æ¸…æ™°
- âœ… æ›´ä½çš„ Chrome ç‰ˆæœ¬è¦æ±‚
- âœ… æ›´å¿«çš„å“åº”é€Ÿåº¦
- âœ… æ›´å®¹æ˜“è°ƒè¯•

---

## ğŸ§© ç»„ä»¶è¯´æ˜

### 1. Content Script (`gmail-monitor.js`)
**åŠŸèƒ½**ï¼šç›‘æ§ Gmail é¡µé¢ï¼Œæå–é‚®ä»¶å†…å®¹

```javascript
// å‘ç°æ–°é‚®ä»¶
emailContent = extractFromGmailDOM();

// å‘é€åˆ° Service Worker å¤„ç†
chrome.runtime.sendMessage({
  action: 'extractOTP',
  emailContent,
  language: 'auto'
});
```

**ä¸åš**ï¼š
- âŒ ä¸è°ƒç”¨ AI
- âŒ ä¸è¿è¡Œæ­£åˆ™
- âŒ åªè´Ÿè´£ç›‘æ§å’Œè½¬å‘

---

### 2. Service Worker (`service-worker.js`)
**åŠŸèƒ½**ï¼šæ¶ˆæ¯è·¯ç”± + OTP æå–å¼•æ“

```javascript
// ä¸¤å±‚å¼•æ“
handleExtractOTP() {
  // 1ï¸âƒ£ æœ¬åœ°æ­£åˆ™ï¼ˆå¿«é€Ÿï¼Œ90%+ è¦†ç›–ç‡ï¼‰
  localResult = otpEngine.extractOTP(emailContent);
  
  if (localResult.confidence > 0.5) {
    return localResult;  // æˆåŠŸï¼
  }
  
  // 2ï¸âƒ£ Gemini API å¤‡ç”¨ï¼ˆäº‘ç«¯ï¼Œéœ€é…ç½®ï¼‰
  apiResult = aiService.extractOTP(emailContent);
  return apiResult;
}
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âš¡ æœ¬åœ°æ­£åˆ™ < 50ms
- ğŸ¯ 90%+ åœºæ™¯ä¸éœ€è¦ AI
- ğŸŒ Gemini API ä½œä¸ºå¤‡ç”¨ï¼ˆå¯é€‰ï¼‰

---

### 3. Popup (`popup.html` + `popup.js`)
**åŠŸèƒ½**ï¼šç”¨æˆ·ç•Œé¢ + Gemini Nano æµ‹è¯•

```javascript
// Popup æœ¬èº«å°±æœ‰ window ç¯å¢ƒï¼
async testGeminiNano() {
  // ç›´æ¥è°ƒç”¨ Prompt API
  const session = await globalThis.LanguageModel.create({
    systemPrompt: 'You are a helpful assistant.'
  });
  
  const result = await session.prompt('Test');
  session.destroy();
}
```

**å…³é”®å‘ç°**ï¼ˆæ„Ÿè°¢ GitHub æ–‡æ¡£ï¼‰ï¼š
> Popup æ˜¯ä¸€ä¸ªå®Œæ•´çš„ HTML é¡µé¢ï¼Œæœ‰ window å¯¹è±¡
> å¯ä»¥ç›´æ¥è®¿é—® `globalThis.LanguageModel`
> **ä¸éœ€è¦ Offscreen Documentï¼**

---

## ğŸ“Š ä¸ºä»€ä¹ˆç§»é™¤äº† Gemini Nano ä» OTP æå–æµç¨‹ï¼Ÿ

### ç†ç”± 1ï¼šæœ¬åœ°æ­£åˆ™å·²ç»è¶³å¤Ÿå¼ºå¤§
```
æµ‹è¯•æ•°æ®ï¼ˆè§ tests/test.jsï¼‰ï¼š
âœ… ä¸­æ–‡é‚®ä»¶ï¼š95% å‡†ç¡®ç‡
âœ… è‹±æ–‡é‚®ä»¶ï¼š98% å‡†ç¡®ç‡
âœ… è¥¿ç­ç‰™è¯­ï¼š92% å‡†ç¡®ç‡
âœ… æ„å¤§åˆ©è¯­ï¼š90% å‡†ç¡®ç‡

å¹³å‡é€Ÿåº¦ï¼š< 50ms
```

### ç†ç”± 2ï¼šGemini Nano æœ‰ç¡¬ä»¶é™åˆ¶
```
è¦æ±‚ï¼š
- GPU æ˜¾å­˜ > 4GB
- æˆ– CPU å†…å­˜ >= 16GB + 4æ ¸å¿ƒ

ç°å®ï¼š
- å¾ˆå¤šç”¨æˆ·è®¾å¤‡ä¸æ»¡è¶³
- ä¸‹è½½æ¨¡å‹éœ€è¦æ—¶é—´
- åˆå§‹åŒ–éœ€è¦ 1-2 ç§’
```

### ç†ç”± 3ï¼šæ¶æ„ç®€åŒ–é™ä½å¤±è´¥ç‡
```
æ—§æ¶æ„ï¼š4 ä¸ªæ½œåœ¨å¤±è´¥ç‚¹
- Content Script å¯èƒ½å´©æºƒ
- Service Worker æ¶ˆæ¯å¯èƒ½ä¸¢å¤±
- Offscreen Document å¯èƒ½åˆ›å»ºå¤±è´¥
- Gemini Nano å¯èƒ½ä¸å¯ç”¨

æ–°æ¶æ„ï¼š2 ä¸ªæ½œåœ¨å¤±è´¥ç‚¹
- Content Script å¯èƒ½å´©æºƒ
- Service Worker æ¶ˆæ¯å¯èƒ½ä¸¢å¤±

å¤±è´¥ç‡é™ä½ 50%ï¼
```

---

## ğŸ¯ Gemini Nano çš„æ–°å®šä½

### ä» "å…³é”®ç»„ä»¶" å˜ä¸º "å¯é€‰å¢å¼º"

**æ—§å®šä½**ï¼ˆå·²åºŸå¼ƒï¼‰ï¼š
```
æœ¬åœ°æ­£åˆ™ â†’ Gemini Nano â†’ Gemini API
       ï¼ˆå¿…éœ€çš„ä¸­é—´å±‚ï¼‰
```

**æ–°å®šä½**ï¼š
```
æœ¬åœ°æ­£åˆ™ â†’ Gemini API
       ï¼ˆä¸»æµç¨‹ï¼‰

Popup â†’ Gemini Nano
    ï¼ˆç‹¬ç«‹æµ‹è¯•/æ¼”ç¤ºï¼‰
```

### æœªæ¥å¯èƒ½çš„ç”¨é€”
1. **ç”¨æˆ·ä¸»åŠ¨è¯·æ±‚**ï¼š
   - ç”¨æˆ·ç‚¹å‡» "æ™ºèƒ½åˆ†æ" æŒ‰é’®
   - Popup è°ƒç”¨ Gemini Nano æ·±åº¦åˆ†æé‚®ä»¶

2. **å¤æ‚åœºæ™¯å¤„ç†**ï¼š
   - å›¾ç‰‡ä¸­çš„éªŒè¯ç ï¼ˆå¤šæ¨¡æ€ï¼‰
   - éæ ‡å‡†æ ¼å¼çš„éªŒè¯ç 

3. **éšç§å¢å¼ºæ¨¡å¼**ï¼š
   - ç”¨æˆ·æ˜ç¡®æ‹’ç»äº‘ç«¯ API
   - åªä½¿ç”¨æœ¬åœ° Nanoï¼ˆç‰ºç‰²å‡†ç¡®ç‡æ¢éšç§ï¼‰

ä½†è¿™äº›éƒ½æ˜¯**å¯é€‰åŠŸèƒ½**ï¼Œä¸æ˜¯æ ¸å¿ƒæµç¨‹ã€‚

---

## ğŸ”§ å¼€å‘è€…æŒ‡å—

### æµ‹è¯• Gemini Nano

1. **å¯ç”¨ Flag**ï¼š
   ```
   chrome://flags/#prompt-api-for-gemini-nano
   è®¾ä¸ºï¼šEnabled
   é‡å¯æµè§ˆå™¨
   ```

2. **æ£€æŸ¥å¯ç”¨æ€§**ï¼š
   ```
   chrome://on-device-internals
   
   åº”è¯¥çœ‹åˆ°ï¼š
   - "Ready" âœ… 
   - æˆ– "Downloading" â³
   ```

3. **åœ¨ Popup ä¸­æµ‹è¯•**ï¼š
   ```
   æ‰“å¼€æ‰©å±• Popup
   ç‚¹å‡» "Test Gemini Nano"
   
   é¢„æœŸï¼š
   - çœ‹åˆ° "Gemini Nano test successful! Response: Hello"
   ```

### è°ƒè¯• OTP æå–

**Service Worker Console**ï¼š
```bash
chrome://extensions/ â†’ "Service Worker" é“¾æ¥

åº”è¯¥çœ‹åˆ°ï¼š
âœ… Background service initialized
âœ… OTP found via local regex (confidence: 0.95)
```

**Gmail Console**ï¼š
```bash
Gmail é¡µé¢ â†’ F12 â†’ Console

åº”è¯¥çœ‹åˆ°ï¼š
âœ… Gmail monitor initialized
```

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | æ—§æ¶æ„ï¼ˆOffscreenï¼‰ | æ–°æ¶æ„ï¼ˆç®€åŒ–ï¼‰ |
|------|-------------------|--------------|
| OTP è¯†åˆ«æ—¶é—´ | 1-2ç§’ | < 50ms |
| åˆå§‹åŒ–æ—¶é—´ | 2-3ç§’ | < 100ms |
| å†…å­˜å ç”¨ | ~500MB | ~50MB |
| Chrome ç‰ˆæœ¬è¦æ±‚ | 116+ | 88+ |
| ç¡¬ä»¶è¦æ±‚ | é«˜ï¼ˆNanoï¼‰ | ä½ï¼ˆæ­£åˆ™ï¼‰ |
| å¤±è´¥ç‡ | ~15% | ~5% |
| ä»£ç å¤æ‚åº¦ | é«˜ | ä½ |

---

## âœ… å½“å‰çŠ¶æ€

### å®Œå…¨å¯ç”¨ âœ…
- Gmail å†…å®¹ç›‘æ§
- æœ¬åœ°æ­£åˆ™ OTP æå–ï¼ˆ90%+ åœºæ™¯ï¼‰
- Gemini API å¤‡ç”¨ï¼ˆéœ€é…ç½®ï¼‰
- Popup UI å’Œè®¾ç½®

### å®éªŒæ€§åŠŸèƒ½ ğŸ§ª
- Gemini Nano æµ‹è¯•ï¼ˆåœ¨ Popup ä¸­ï¼‰
- éœ€è¦ç¡¬ä»¶æ”¯æŒ
- ä»…ç”¨äºæ¼”ç¤ºå’Œæœªæ¥æ‰©å±•

---

## ğŸ“ å…³é”®å­¦ä¹ 

### 1. ä¸è¦è¿‡åº¦ä¾èµ– AI
```
é”™è¯¯æ€è·¯ï¼šæ‰€æœ‰ OTP éƒ½ç”¨ AI è¯†åˆ«
æ­£ç¡®æ€è·¯ï¼š90% ç”¨æ­£åˆ™ï¼Œ10% ç”¨ AI
```

### 2. ä¼˜å…ˆè€ƒè™‘å…¼å®¹æ€§
```
é”™è¯¯æ€è·¯ï¼šå‡è®¾æ‰€æœ‰ç”¨æˆ·éƒ½æœ‰é«˜ç«¯ç¡¬ä»¶
æ­£ç¡®æ€è·¯ï¼šåœ¨ä½ç«¯è®¾å¤‡ä¸Šä¹Ÿè¦æµç•…è¿è¡Œ
```

### 3. ç®€å•å°±æ˜¯ç¾
```
é”™è¯¯æ€è·¯ï¼šå±•ç¤ºæŠ€æœ¯å¤æ‚æ€§
æ­£ç¡®æ€è·¯ï¼šç”¨æˆ·åªå…³å¿ƒ"æ˜¯å¦æœ‰æ•ˆ"
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**ä½œè€…**: Gmail OTP AutoFill Team  
**æœ€åæ›´æ–°**: 2025-10-27

